layui.define(["element","form","table","md5"],(function(exports){var $=layui.jquery,element=layui.element,layer=layui.layer,form=layui.form,table=layui.table,md5=layui.md5,checkBrowser;(function(){var d=layui.device();d.ie&&d.ie<10&&layer.alert("IE"+d.ie+"下体验不佳，推荐使用：Chrome/Firefox/Edge/极速模式")})();var lockscreen=function(){$(".lock-screen",parent.document)[0]||(document.oncontextmenu=new Function("event.returnValue=false;"),document.onselectstart=new Function("event.returnValue=false;"),layer.open({title:!1,type:1,content:'<div class="lock-screen"><input type="password" id="unlockedPwd" class="layui-input" placeholder="请输入登录密码解锁..." autocomplete="on"><button id="unlocked" class="layui-btn">解锁</button></div>',closeBtn:0,shade:.95,offset:"350px"}),$("#unlocked").click((function(){var pwd=$("#unlockedPwd").val();if(""==pwd)return!1;$.post(ADMIN_PATH+"/system/publics/unlocked",{password:md5.exec(pwd)},(function(res){1==res.code?(window.sessionStorage.setItem("lockscreen",!1),layer.closeAll()):$("#unlockedPwd").attr("placeholder",res.msg).val("")}))})))};if($("#lockScreen").click((function(){window.sessionStorage.setItem("lockscreen",!0),lockscreen()})),"true"==window.sessionStorage.getItem("lockscreen")&&lockscreen(),$(".admin-nav-item").click((function(){window.localStorage.setItem("adminNavTag",$(this).attr("href"))})),window.localStorage.getItem("adminNavTag")&&$('#switchNav a[href="'+window.localStorage.getItem("adminNavTag")+'"]').parent("dd").addClass("layui-this").parents("li").addClass("layui-nav-itemed").siblings("li").removeClass("layui-nav-itemed"),"undefined"==typeof LAYUI_OFFSET?layer.config({offset:"60px"}):layer.config({offset:LAYUI_OFFSET}),$("#foldSwitch").click((function(){var that=$(this);that.hasClass("ai-zhankaicaidan")?($('a[href="'+window.localStorage.getItem("adminNavTag")+'"]').parent("dd").addClass("layui-this").parents("li").addClass("layui-nav-itemed").siblings("li").removeClass("layui-nav-itemed"),that.removeClass("ai-zhankaicaidan").addClass("ai-shouqicaidan"),$("#switchNav").animate({width:"200px"},100).removeClass("close"),$("#switchBody,.footer").animate({left:"200px"},100),$("#switchNav .fold-mark").removeClass("fold-mark")):(that.addClass("ai-zhankaicaidan").removeClass("ai-shouqicaidan"),$("#switchNav").animate({width:"43px"},100).addClass("close").hover((function(){that.hasClass("ai-zhankaicaidan")&&($(this).animate({width:"200px"},300),$("#switchNav .fold-mark").removeClass("fold-mark"),$('a[href="'+window.localStorage.getItem("adminNavTag")+'"]').parent("dd").addClass("layui-this").parents("li").addClass("layui-nav-itemed").siblings("li").removeClass("layui-nav-itemed"))}),(function(){that.hasClass("ai-zhankaicaidan")&&($(this).animate({width:"43px"},300),$("#switchNav .layui-nav-item").addClass("fold-mark").removeClass("layui-nav-itemed"))})),$("#switchBody,.footer").animate({left:"43px"},100),$("#switchNav .layui-nav-item").addClass("fold-mark").removeClass("layui-nav-itemed"))})),$(".help-tips").click((function(){return layer.tips($(this).attr("data-title"),this,{tips:[3,"#009688"],time:5e3}),!1})),$("#fullscreen-btn").click((function(){var that=$(this);that.hasClass("ai-quanping")?($("#switchBody").css({"z-index":998}),$("#switchNav").css({"z-index":1e3}),that.addClass("ai-quanping1").removeClass("ai-quanping").parents(".page-body").removeClass("fullscreen"),$(".page-tab-content").css({"min-height":"auto"})):($("#switchBody").css({"z-index":1e4}),$("#switchNav").css({"z-index":900}),that.addClass("ai-quanping").removeClass("ai-quanping1").parents(".page-body").addClass("fullscreen"),$(".page-tab-content").css({"min-height":$(window).height()-63+"px"}))})),form.on("checkbox(allChoose)",(function(data){var child;$(data.elem).parents("table").find("tbody input.checkbox-ids").each((function(index,item){item.checked=data.elem.checked})),form.render("checkbox")})),$("#hisi-theme-setting").on("click",(function(){var that=$(this);return layer.open({type:5,title:"主题方案",shade:.3,area:["295px","93%"],offset:"rb",maxmin:!0,shadeClose:!0,closeBtn:!1,anim:2,content:$("#hisi-theme-tpl").html(),success:function(layero,index){$(".hisi-themes li").on("click",(function(){var theme=$(this).attr("data-theme");$.get(that.attr("href"),{theme:theme},(function(res){0==res.code?layer.msg(res.msg):($("body").prop("class","hisi-theme-"+theme),$(".hisi-themes li").removeClass("active"),$("#hisi-theme-item-"+theme).addClass("active"))}),"json")}))}}),!1})),$("#hisi-clear-cache").on("click",(function(){var that=$(this);return layer.open({type:5,title:"删除缓存",shade:.3,area:["205px","93%"],offset:"rb",maxmin:!0,shadeClose:!0,closeBtn:!1,anim:2,content:$("#hisi-clear-cache-tpl").html(),success:function(layero,index){form.render("checkbox")}}),!1})),$(".j-del-menu,.hisi-del-menu").click((function(){var that=$(this);layer.confirm("删除之后无法恢复，您确定要删除吗？",{title:!1,closeBtn:0},(function(index){$.post(that.attr("data-href"),(function(res){layer.msg(res.msg),1==res.code&&that.parents("dd").animate({left:"-1000px"},(function(){$(this).remove()}))})),layer.close(index)}))})),$(document).on("click",".j-iframe-pop,.hisi-iframe-pop,.hisi-iframe",(function(){var that=$(this),query="",def={width:"750px",height:"500px",idSync:!1,table:"dataTable",type:2,url:that.attr("href"),title:that.attr("title")},opt=new Function("return "+that.attr("hisi-data"))()||{};if(!(opt=Object.assign({},def,opt)).url)return layer.msg("请设置href参数"),!1;if(opt.idSync){if($(".checkbox-ids:checked").length>0)$(".checkbox-ids:checked").each((function(){query+="&id[]="+$(this).val()}));else{var checkStatus=table.checkStatus(opt.table);for(var i in checkStatus.data)query+="&id[]="+checkStatus.data[i].id}if(!query)return layer.msg("请选择要操作的数据"),!1}return opt.url.indexOf("?")>=0?opt.url+="&hisi_iframe=yes"+query:opt.url+="?hisi_iframe=yes"+query,layer.open({type:opt.type,offset:"auto",title:opt.title,content:opt.url,area:[opt.width,opt.height]}),!1})),form.on("switch(switchStatus)",(function(data){var that=$(this),status=0,func=function(){$.get(that.attr("data-href"),{val:status},(function(res){layer.msg(res.msg),0==res.code&&(that.trigger("click"),form.render("checkbox"))}))};if(void 0===that.attr("data-href"))return layer.msg("请设置data-href参数"),!1;this.checked&&(status=1),void 0===that.attr("confirm")?func():layer.confirm(that.attr("confirm")||"你确定要执行操作吗？",{title:!1,closeBtn:0},(function(index){func()}),(function(){that.trigger("click"),form.render("checkbox")}))})),form.on("submit(formSubmit)",(function(data){var _form="",that=$(this),text=that.text(),opt={},def={pop:!1,refresh:!0,jump:!1,callback:null,time:3e3};if(_form=$(this).attr("data-form")?$(that.attr("data-form")):$(data.form),that.attr("hisi-data")?opt=new Function("return "+that.attr("hisi-data"))():that.attr("lay-data")&&(opt=new Function("return "+that.attr("lay-data"))()),opt=Object.assign({},def,opt),"undefined"!=typeof CKEDITOR)for(instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement();return that.removeClass("layui-btn-normal").addClass("layui-btn-disabled").prop("disabled",!0).text("提交中..."),$.ajax({type:"POST",url:_form.attr("action"),data:_form.serialize(),success:function(res){that.removeClass("layui-btn-disabled"),0==res.code?(that.text(res.msg).prop("disabled",!1).removeClass("layui-btn-normal").addClass("layui-btn-danger"),setTimeout((function(){that.removeClass("layui-btn-danger").addClass("layui-btn-normal").text(text)}),opt.time)):opt.callback?opt.callback(that,res):(that.addClass("layui-btn-normal").text(res.msg),setTimeout((function(){that.text(text).prop("disabled",!1),1==opt.pop?(1==opt.refresh?parent.location.reload():1==opt.jump&&""!=res.url&&(parent.location.href=res.url),parent.layui.layer.closeAll()):1==opt.refresh&&(""!=res.url?location.href=res.url:history.back(-1))}),opt.time))}}),!1})),$(document).on("click",".j-tr-del,.hisi-tr-del",(function(){var that=$(this),href=that.attr("data-href")?that.attr("data-href"):that.attr("href");return layer.confirm("删除之后无法恢复，您确定要删除吗？",{title:!1,closeBtn:0},(function(index){if(!href)return layer.msg("请设置data-href参数"),!1;$.get(href,(function(res){0==res.code?layer.msg(res.msg):that.parents("tr").remove()})),layer.close(index)})),!1})),$(document).on("click",".j-ajax,.hisi-ajax",(function(){var that=$(this),href=that.attr("data-href")?that.attr("data-href"):that.attr("href"),refresh=that.attr("refresh")?that.attr("refresh"):"true";return href?(that.attr("confirm")?layer.confirm(that.attr("confirm"),{title:!1,closeBtn:0},(function(index){layer.msg("数据提交中...",{time:5e5}),$.get(href,{},(function(res){layer.msg(res.msg,{},(function(){"true"==refresh&&(void 0!==res.url&&null!=res.url&&""!=res.url?location.href=res.url:location.reload())}))})),layer.close(index)})):(layer.msg("数据提交中...",{time:5e5}),$.get(href,{},(function(res){layer.msg(res.msg,{},(function(){"true"!=refresh&&"yes"!=refresh||(void 0!==res.url&&null!=res.url&&""!=res.url?location.href=res.url:location.reload())}))})),layer.close()),!1):(layer.msg("请设置data-href参数"),!1)})),$(document).on("blur",".j-auto-checked,hisi-auto-checked",(function(){var that=$(this);that.attr("data-value")!=that.val()?that.parents("tr").find('input[name="ids[]"]').attr("checked",!0):that.parents("tr").find('input[name="ids[]"]').attr("checked",!1),form.render("checkbox")})),$(document).on("focusout",".j-ajax-input,.hisi-ajax-input",(function(){var that=$(this),_val=that.val();return""!=_val&&(that.attr("data-value")!=_val&&(that.attr("data-href")?void $.post(that.attr("data-href"),{val:_val},(function(res){1==res.code&&that.attr("data-value",_val),layer.msg(res.msg)})):(layer.msg("请设置data-href参数"),!1)))})),$(".tooltip").hover((function(){var that;$(this).find("i").show()}),(function(){var that;$(this).find("i").hide()})),$(document).on("click",".j-page-btns,.hisi-page-btns,.hisi-table-ajax",(function(){var that=$(this),query="",code=function(that){var href=that.attr("href")?that.attr("href"):that.attr("data-href"),tableObj=that.attr("data-table")?that.attr("data-table"):"dataTable";if(!href)return layer.msg("请设置data-href参数"),!1;if($(".checkbox-ids:checked").length<=0){var checkStatus=table.checkStatus(tableObj);if(checkStatus.data.length<=0)return layer.msg("请选择要操作的数据"),!1;for(var i in checkStatus.data)i>0&&(query+="&"),query+="id[]="+checkStatus.data[i].id}else query=that.parents("form")[0]?that.parents("form").serialize():$("#pageListForm").serialize();layer.msg("数据提交中...",{time:5e5}),$.post(href,query,(function(res){layer.msg(res.msg,{},(function(){0!=res.code&&location.reload()}))}))};if(that.hasClass("confirm")){var tips=that.attr("tips")?that.attr("tips"):"您确定要执行此操作吗？";layer.confirm(tips,{title:!1,closeBtn:0},(function(index){code(that),layer.close(index)}))}else code(that);return!1})),$(document).on("submit","#hisiSearch,#hisi-table-search",(function(){var that=$(this),arr=that.serializeArray(),where=new Array,dataTable=that.attr("data-table")?that.attr("data-table"):"dataTable",options=new Function("return "+that.attr("hisi-data"))()||{page:{curr:1}};for(var i in arr)where[arr[i].name]=arr[i].value;return options.url=that.attr("action"),options.where=where,table.reload(dataTable,options),!1})),$(document).on("click",".hisi-table-a-filter",(function(){var that=$(this),dataTable=that.attr("data-table")?that.attr("data-table"):"dataTable",options=new Function("return "+that.attr("hisi-data"))()||{page:{curr:1}};return options.url=that.attr("href"),table.reload(dataTable,options),!1})),$(".hs-first-menu")[0]){var renderFirstMenu=function(){for(var h="",w=$(".hs-first-menu").width(),l=parseInt(w/140)-1,i=0;i<l;i++)HSMENUS[i]&&(h+='<li class="layui-nav-item" id="hs-first-menu'+HSMENUS[i].id+'"><a href="javascript:;" class="hs-first-menu-a" data-id="'+HSMENUS[i].id+'"><i class="'+(HSMENUS[i].icon?HSMENUS[i].icon:"fa fa-list")+'"></i> '+HSMENUS[i].title+"</a></li>");if(HSMENUS[l]){h+='<li class="layui-nav-item"><a href="javascript:void(0);"><i class="fa fa-th"></i></a>',h+='<dl class="layui-nav-child">';for(var i=l;i<HSMENUS.length;i++)h+='<dd><a href="javascript:;" class="hs-first-menu-a"><i class="'+(HSMENUS[i].icon?HSMENUS[i].icon:"fa fa-list")+'"></i> '+HSMENUS[i].title+"</a></dd>";h+="</dl></li>"}$(".hs-first-menu").html(h).show(),element.render()};$(window).resize((function(){renderFirstMenu()})),renderFirstMenu(),$(document).on("click",".hs-first-menu-a",(function(){var that=$(this),i=$(".hs-first-menu-a").index(this);$(".layui-nav-tree").hide().eq(i).show()}))}exports("global",{})}));